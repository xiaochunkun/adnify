# 更新日志 | Changelog

> 每一次更新，都是一杯新泡的茶 ☕

所有重要更改都会记录在此文件中。格式基于 [Keep a Changelog](https://keepachangelog.com/)，版本号遵循 [Semantic Versioning](https://semver.org/)。

## 贡献者 | Contributors

感谢所有为 Adnify 做出贡献的开发者！你们是最棒的 🎉

<!-- ALL-CONTRIBUTORS-LIST:START -->
<a href="https://github.com/adnaan-worker"><img src="https://github.com/adnaan-worker.png" width="50" height="50" style="border-radius:50%" alt="adnaan"/></a>
<a href="https://github.com/kerwin2046"><img src="https://github.com/kerwin2046.png" width="50" height="50" style="border-radius:50%" alt="kerwin"/></a>
<a href="https://github.com/cniu6"><img src="https://github.com/cniu6.png" width="50" height="50" style="border-radius:50%" alt="cniu6"/></a>
<!-- ALL-CONTRIBUTORS-LIST:END -->

---

## [1.6.11] - 2026-02-07 🎭 情感计算与编排增强

> "不仅能干活，还能懂你的情绪" —— Agent 智商情商双提升

### ✨ 新功能
- 🧠 **Orchestrator 编排系统** (adnaan)
  - 增强的任务看板 UI，Markdown 需求文档渲染
  - 交互式 `ask_user` 卡片组件重构
  - 任务计划持久化与 EditorTabs 友好显示
  - 多轮任务规划与并行执行支持
- 🎭 **情感计算模块** (kerwin)
  - 引入情感检测与适应系统
  - 实时上下文情感分析与 LLM 集成
  - 情感状态指示器与编辑器栏集成
  - 情感反馈机制（含音频播放）与本地化支持
- 🏥 **模型健康检查** (cniu6)
  - 添加模型测试功能
  - 获取模型列表支持
- 🌐 **国际化** (cniu6)
  - 检查点面板添加 i18n 支持
- 🔒 **安全 HTML渲染** (kerwin)
  - 新增 SafeHTML 和 SafeMarkdownHTML 组件
- 📂 **文件操作增强** (kerwin)
  - 支持在浏览器中打开文件功能

### 🔧 技术改进 / 重构
- 🏗️ **Agent 架构优化** (adnaan)
  - 移除旧版 Plan 模式，为新设计铺路
  - 简化 LLM 流式架构，修复首轮对话挂起
  - 线程隔离与上下文警告系统
  - 压缩预测器与 StreamingBuffer 优化
- 📂 **文件缓存服务** (kerwin)
  - 替换 CacheService 为 fileCacheService

### 🐛 Bug 修复
- 🔧 **Shell 执行错误处理** (adnaan)
  - 改进 Shell 命令错误捕获

---

## [1.6.10] - 2026-01-30 🐛 问题修复

> "小步快跑，持续迭代" —— Bug 修复

### 🐛 Bug 修复
- 🔧 **LLM 设置** (adnaan)
  - 修复无法删除自定义模型提供商的问题
- 🎨 **主题样式** (adnaan)
  - 修复 Dawn 主题下的聊天消息显示样式

---

## [1.6.9] - 2026-01-29 🚀 结构化输出与性能优化

> "精准的 Token 计数，强大的结构化生成" —— AI 能力再升级

### ✨ 新功能
- 🧠 **结构化对象生成** - 支持 Schema 约束的 AI 输出
  - 新增 `generateObject` IPC 处理器
  - 支持 Zod Schema 和 JSON Schema 格式
  - 自动 JSON Schema 到 Zod 转换
  - 改进图片压缩，自动提取描述
  - 更好的 Token 估算和消息准备
- 📊 **精准 Token 计数** - 集成 js-tiktoken
  - 新增 `countTokens` 和 `countContentTokens` 工具函数
  - 替换近似估算逻辑为精确计数
  - 改进中文字符、代码和结构化内容的 Token 估算
  - 更新 CompressionManager 使用精确计数
  - 添加完整的测试覆盖
- 🏥 **健康检查系统** - 提供商连接验证
  - 在主进程实现健康检查，避免 CORS 问题
  - 支持多个提供商（OpenAI、Anthropic、DeepSeek、Groq、Mistral、Ollama、NVIDIA）
  - 跟踪提供商状态、延迟和错误
  - 可配置超时和 baseURL 支持
  - 使用 AbortController 处理网络超时
- 🐘 **PHP LSP 支持** - 新增 PHP 语言服务器
  - 集成 Intelephense 语言服务器
  - 支持 PHP 项目智能根目录检测（composer.json、phpunit.xml 等）
  - 自动安装和配置
  - 完整的代码补全、跳转和诊断支持

### 🎨 UI/UX 优化
- 💬 **消息流畅度提升** - 改进消息显示效果
- 🎯 **Hooks 重构** - 拆分 `useCloseOnOutsideOrEscape`
  - 分离为 `useClickOutside` 和 `useEscapeKey`
  - 更好的关注点分离
  - 改进点击外部检测逻辑
  - 更易于独立测试

### 🔧 技术改进
- 🏗️ **LSP 平台工具提取** - 提取平台检测逻辑到共享工具函数
  - 新增 `getExecutableName` 和 `getNpmCommand` 工具函数
  - 集中管理平台特定命令解析
  - 减少跨模块的平台逻辑重复
  - 提升代码可维护性
- 🎨 **Monaco 类型兼容性** - 改进 ESM 和 UMD 模块导入
  - 更新 Monaco 类型引用支持两种导入路径
  - 扩展编辑器、Diff 编辑器和 AI 补全的参数类型
  - 提升不同 Monaco 打包策略的灵活性
- 🛡️ **LLM 类型安全** - 改进类型约束
  - 简化 `StructuredService` 泛型约束
  - 改进 JSON Schema 到 Zod 转换器的类型安全
  - 更好的类型兼容性和灵活性
- 🧹 **代码清理** - 移除 LSP 安装器和管理器模块中的尾随空格

---

## [1.6.8] - 2026-01-29 🛡️ 错误处理标准化

> "统一的错误处理，更好的调试体验" —— 全面重构错误处理

### 🔧 技术改进
- 🛡️ **错误处理标准化** - 使用 `toAppError` 工具统一错误处理
  - 重构所有 IPC 处理器（debug、llm、lsp、mcp、resources）
  - 更新 LSP 安装器和管理器模块
  - 标准化安全模块错误处理（fileWatcher、secureFile、secureTerminal）
  - 改进 StreamingService 错误类型转换
  - 更新 MCP 客户端、配置加载器和管理器
  - 统一终端、工作区和补全服务错误处理
  - 重构共享错误处理工具，提升类型安全
- 🌐 **错误消息本地化** - 改进错误消息国际化
  - `LLMError.fromAISDKError()` 默认使用英文，前端负责本地化
  - 流处理器支持基于错误代码的国际化
  - MCP 服务集成语言偏好设置
  - 分离错误映射（技术细节）和消息本地化（用户界面）
- 📊 **错误上下文保留** - 改进整个错误处理管道的上下文保存
  - 从 API 响应体提取详细错误信息
  - 更好的调试支持

---

## [1.6.7] - 2026-01-28 🎨 设置界面增强

> "自定义请求头，配置更灵活" —— 提供商配置升级

### ✨ 新功能
- 🔧 **自定义请求头支持** - 提供商配置支持自定义 HTTP 头
  - 新增请求头管理界面
  - 支持协议特定的默认请求头
  - 切换提供商时保留请求头配置
- 📜 **ScrollShadow 组件** - 更好的滚动内容处理
  - 改进设置页面滚动体验
  - 模型配置区域支持滚动

### 🔧 技术改进
- 🏗️ **提供商配置优化** - 改进配置管理逻辑
  - 使用 `displayName` 替代 `name` 字段
  - 重构请求头同步逻辑
  - 改进设置持久化，包含请求头配置
- 🧠 **LLM AI SDK 增强** - 改进媒体类型处理
  - 图片内容转换支持 `mediaType`
  - base64 图片默认使用 `image/png` 类型
  - 移除自定义 baseURL OpenAI 兼容模式逻辑
  - 重构 `streamText` 参数结构
  - 添加提供商特定的思考模式配置（OpenAI、Anthropic、Google）
  - 支持 OpenAI 特定参数（logitBias、parallelToolCalls、reasoningEffort）
  - 添加超时和重试配置支持

### 🐛 Bug 修复
- 🔐 **CSP 安全策略** - 允许 blob URL 支持图片粘贴
  - 更新 Content Security Policy `img-src` 指令
  - 支持剪贴板图片操作

---

## [1.6.6] - 2026-01-27 🚀 性能优化与体验提升

> "快如闪电，稳如磐石" —— 全方位性能优化

### ✨ 新功能
- 🎨 **React 性能优化库** - 新增 `usePerformance.ts` 提供 10+ 性能优化 Hooks
  - `useClickOutside` - 点击外部关闭（支持多 refs）
  - `useDebounce` / `useThrottle` - 防抖节流
  - `useEventListener` - 优化的事件监听
  - `useStableCallback` - 稳定的回调引用
  - `useEscapeKey` - ESC 键关闭
  - `useDebouncedValue` - 防抖值
  - `usePrevious` - 上一次的值
  - `useIsMounted` - 挂载状态检查

### 🚀 性能优化
- ⚡ **React 组件优化** - 7+ 组件添加 `React.memo`，减少重渲染 20-30%
  - `ContextMenu` - 上下文菜单优化
  - `Modal` - 模态框优化
  - `BottomBarPopover` - 底部弹出框优化
  - `SettingsModal` - 设置弹窗优化（9 个 useEffect 合并为 1 个）
  - `TerminalPanel` - 终端面板优化
  - `Select` - 选择器优化
  - `VirtualFileTree` - 虚拟文件树优化
- 🎯 **GitView 子组件优化** - 5 个子组件全部优化
  - `FileStatusBadge` - 文件状态徽章
  - `FileItem` - 文件项
  - `BranchItem` - 分支项
  - `CommitItem` - 提交项
  - `StashItem` - 暂存项
- 📊 **LSP 诊断同步优化** - CPU 使用降低 60%
  - 从轮询改为事件驱动（`onDidChangeMarkers`）
  - 添加 500ms 防抖避免频繁同步
  - Monaco markers 自动同步到 diagnosticsStore
  - 修复编辑器错误不显示在错误面板的问题

### 🔧 技术改进
- 🌐 **语言支持统一** - 统一管理 LSP 支持的语言
  - 单一真实来源：`LSP_SUPPORTED_LANGUAGES`
  - 支持 15+ 语言（TypeScript, JavaScript, HTML, CSS, Python, Go, Rust, C/C++, C#, Zig, Vue 等）
  - 所有组件从 `@shared/languages` 导入
- 🎨 **骨架屏优化** - 修复 SettingsSkeleton 跳动问题
  - 骨架屏在弹窗内显示，不再跳动
  - 包含完整 Modal 样式
- 🧹 **代码清理** - 删除设置中重复的关于模块
- 📝 **TypeScript 优化** - 所有文件通过类型检查（0 错误）

### 🐛 Bug 修复
- 🔧 **LSP 错误检测** - 修复编辑器中的错误不显示在错误面板和底部统计的问题
- 🚫 **ES6 模块** - 修复 `require is not defined` 错误，改用 ES6 import
- 🎯 **点击外部关闭** - 统一使用 `useClickOutside` Hook，避免重复代码

### 📊 性能提升总结
- React 组件重渲染减少 20-30%
- LSP 诊断同步 CPU 使用降低 60%
- 语言支持统一，代码维护性提升
- 类型检查全部通过，代码质量提升

---

## [1.6.5] - 2026-01-26 🔧 模型提供商优化

> "兼容性更强，配置更灵活" —— 支持自定义 API 端点

### ✨ 新功能
- 🔌 **OpenAI Compatible 模式** - 内置 OpenAI 提供商支持自定义 baseURL
  - 自动检测自定义 baseURL 并切换到兼容模式
  - 支持 NVIDIA API、OpenRouter 等第三方 API
  - 显式使用 Chat Completions API (`/v1/chat/completions`)

### 🐛 Bug 修复
- 🔄 **模型选择器实时更新** - 添加/删除模型后立即更新下拉列表
  - 调用 `setProvider()` 立即同步状态
  - 无需保存即可看到变化
- 🌐 **API 端点兼容性** - 修复使用自定义 baseURL 时的 404 错误
  - 第三方 API 只支持 Chat Completions API
  - 避免错误调用 Responses API

### 🔧 技术改进
- 🏗️ **模型工厂优化** - `modelFactory.ts` 智能检测 API 类型
- 📝 **提供商设置优化** - `ProviderSettings.tsx` 实时状态同步

---

## [1.6.4] - 2026-01-26 🛡️ 安全与工具优化

> "更安全，更可控" —— 工具调用节流与审批优化

### ✨ 新功能
- 🛡️ **工具参数节流** - 防止工具调用过于频繁
- ✅ **审批逻辑改进** - 工具调用审批机制优化

### 🔧 技术改进
- 🔐 **多窗口工作区隔离** - 通过 IPC 事件上下文实现安全隔离

---

## [1.6.3] - 2026-01-26 🔄 LLM 服务重构

> "架构更清晰，扩展更容易" —— LLM 服务模块化

### 🔧 技术改进
- 🏗️ **LLM 服务重构** - 使用专门的处理器和嵌入支持
  - 模块化架构，职责分离
  - 统一 token 使用格式（IPC 和流式）
  - 添加流式工具调用事件，支持增量参数更新
- 📊 **工具调用流式优化** - 合并工具调用流式事件，添加 activeTools 过滤
- 💾 **Node.js 堆内存优化** - 增加 TypeScript 编译的堆大小

### 🐛 Bug 修复
- 📝 **文件名大小写** - 修正 `LLMService.ts` 文件名大小写
- 🔧 **TypeScript 编译错误** - 解决 LLM 服务中的类型错误

---

## [1.6.2] - 2026-01-25 ⚙️ 设置管理优化

> "状态管理更合理" —— 提供商配置迁移到本地状态

### 🔧 技术改进
- 🏗️ **提供商配置管理** - 迁移到本地状态管理
  - 更好的性能和响应速度
  - 减少不必要的全局状态更新

---

## [1.6.1] - 2026-01-25 🔧 工具执行优化

> "并发控制，日志增强" —— 工具执行更稳定

### ✨ 新功能
- 🔄 **并发限制** - 工具执行添加并发控制
- 📊 **增强日志** - 工具执行过程详细日志记录

---

## [1.6.0] - 2026-01-25 🚀 LLM 引擎大换血

> "底层重构了，记得重新配置 API Key 哦" —— 升级必读

### ⚠️ 重要提示
- 🔄 **LLM 引擎重构** - 迁移到 Vercel AI SDK，性能更强、兼容性更好
- ⚙️ **配置需要重新设置** - 升级后请重新配置你的 LLM API Key 和相关设置
- 📝 **设置界面优化** - LLM 配置界面全新改版，更直观易用

### ✨ 新功能
- 🧠 **Vercel AI SDK 集成** - 统一的 LLM 调用接口，支持更多模型
- 🔧 **工具参数规范化** - 递归属性标准化，工具调用更稳定
- 🛡️ **参数解析增强** - 更健壮的工具参数解析和验证机制
- 📦 **许可证文件** - 打包时自动包含 LICENSE 和 NOTICE 文件
- 📄 **关于页面更新** - 新增版本信息和许可证说明

### 🎨 UI/UX 优化
- ✨ **分支控制优化** - 更流畅的分支切换动画和样式
- 🎯 **消息动画增强** - 聊天消息过渡效果更自然
- 🔄 **Agent 组件重构** - 分支管理 UI 结构优化，交互更清晰

### 🔧 技术改进
- 🏗️ **设置状态管理** - 文件日志状态提升到父组件，逻辑更清晰
- 📊 **日志诊断增强** - 设置和 LSP 安装器添加全面的日志记录
- 🎨 **语义化设计系统** - Toast 和 Dialog 组件迁移到语义化设计
- 🌈 **主题系统重构** - 硬编码颜色全部替换为 CSS 变量
- 💬 **消息布局重构** - 聊天消息布局和样式系统重新设计
- 📝 **编辑器配置整合** - 统一管理编辑器配置状态

### 🚀 性能优化
- ⚡ **流式缓冲机制** - Agent Store 添加消息部分的流式缓冲刷新
- 🎯 **Tooltip 包装器** - 移除自定义 memo 比较器，性能更优
- 📦 **GFM 支持** - 聊天消息支持 GitHub Flavored Markdown

### 💡 升级指南
1. 升级到 v1.6.0 后，请前往设置页面
2. 重新配置你的 LLM API Key（OpenAI/Anthropic/Google 等）
3. 检查模型选择是否正确
4. 测试一下对话功能，确保一切正常

### 🎉 为什么要重构？
- 更好的模型兼容性 - 支持更多 LLM 提供商
- 更稳定的工具调用 - 参数解析更健壮
- 更现代的架构 - Vercel AI SDK 是业界标准
- 更好的维护性 - 代码更清晰，bug 更少

---

## [1.5.20] - 2026-01-24 🎨 UI 细节打磨

> "细节决定体验" —— 分支控制和动画优化

### 🎨 UI/UX 优化
- ✨ **分支控制增强** - 分支切换按钮样式优化，交互更流畅
- 🎯 **消息动画改进** - 聊天消息过渡动画更自然，视觉体验更好
- 🔄 **Agent 组件重构** - 分支管理 UI 结构优化，代码更清晰

### 🔧 技术改进
- 🏗️ **设置状态提升** - 文件日志状态管理优化，逻辑更合理

---

## [1.5.19] - 2026-01-23 📊 日志系统增强

> "出问题了？看日志就知道" —— 诊断能力大提升

### ✨ 新功能
- 📊 **全面日志记录** - 设置页面和 LSP 安装器添加详细的日志和诊断信息
- 🔍 **问题追踪** - 更容易定位和解决配置问题

### 🎨 UI/UX 优化
- 🎯 **Tooltip 优化** - 移除自定义 memo 比较器，添加统一的 Tooltip 包装器
- 🎨 **语义化设计** - Toast 和 Dialog 组件迁移到语义化设计系统
- 🌈 **主题变量** - 硬编码颜色替换为语义化 CSS 变量
- 💬 **消息布局重构** - 聊天消息布局和样式系统重新设计

### 🔧 技术改进
- 🎨 **CSS 变量系统** - 主题颜色全部迁移到 CSS 自定义属性，更易维护

---

## [1.5.18] - 2026-01-22 ⚡ 性能与配置优化

> "更快的响应，更好的配置" —— 流式体验升级

### 🚀 性能优化
- ⚡ **流式缓冲机制** - Agent Store 添加消息部分的流式缓冲刷新，响应更快
- 📦 **GFM 支持** - 聊天消息支持 GitHub Flavored Markdown，表格、任务列表都能正常显示

### 🔧 技术改进
- 📝 **编辑器配置整合** - 统一管理编辑器配置状态，代码更清晰
- 🏗️ **状态管理优化** - 配置状态管理逻辑重构

---

## [1.5.17] - 2026-01-20 📄 Markdown 增强

> "表格、任务列表，统统支持" —— GFM 来了

### ✨ 新功能
- 📄 **GitHub Flavored Markdown** - 聊天消息支持 GFM 语法
  - ✅ 任务列表（- [ ] / - [x]）
  - 📊 表格渲染
  - 🔗 自动链接识别
  - ~~删除线~~ 支持

### 🎨 UI/UX 优化
- 💬 **消息渲染优化** - Markdown 渲染效果更美观，代码高亮更清晰

---

## [1.5.16] - 2026-01-17 🧠 AI 终于记得你说了啥

> "上下文满了？没事，我帮你续上" —— 智能摘要系统上线

### ✨ 新功能
- 🤖 **LLM 智能摘要** - L3/L4 压缩时自动调用 LLM 生成结构化摘要，不再是简单的规则提取
- 📋 **未完成需求追踪** - L4 Handoff 现在能准确识别最后一个请求是否完成，自动加入待办列表
- ⚡ **增量索引更新** - 文件改了？索引自动更新，不用重建整个索引了
- 🔄 **智能文件监听** - 保存文件后自动更新 BM25 和符号索引，搜索结果实时同步

### 🎯 优化
- 📊 **摘要上下文可配置** - Quick(8k) / Detailed(12k) / Handoff(16k)，不同场景不同长度
- 🧠 **结构化 Handoff** - JSON 格式提取目标、已完成、待办、关键决策、用户约束
- 🎨 **摘要质量提升** - 从后往前取消息，确保最近的对话和最后的请求不丢失
- 🗑️ **索引删除支持** - 文件删除后自动从 BM25 和符号索引中移除

### 🔧 技术细节
- 📝 **Handoff Prompt 优化** - 明确要求 AI 判断最后请求的完成状态
- 🔍 **BM25Index.deleteFile()** - 支持按文件路径删除文档
- 🏷️ **SymbolIndex.deleteFile()** - 同步删除文件的所有符号
- 💾 **自动保存索引** - 增量更新后自动保存到 `.adnify/structural-index.json`

### 🐛 Bug 修复
- 🔒 **Shell 路径验证** - 更严格的系统命令路径检查，防止注入攻击
- 🖥️ **UI 布局改进** - Mac 窗口控制按钮位置修正 (感谢 @kerwin)
- 💥 **终端崩溃修复** - 增强错误处理，终端不再莫名其妙挂掉 (感谢 @kerwin)
- 📦 **导入清理** - 移除多余的 import，代码更清爽 (感谢 @kerwin)

### 💡 使用建议
- 开启 `enableLLMSummary` 配置以使用 LLM 摘要（需要 API Key）
- Handoff 摘要会自动包含未完成的需求，新会话可以无缝继续
- 文件监听默认开启，索引会自动保持最新

---

## [1.5.15] - 2026-01-16 🧠 AI 终于懂你的项目了

> "不用再解释项目结构了，AI 自己会看" —— 懒人福音

### ✨ 新功能
- 🧠 **双模式索引架构** - 结构化索引（零配置本地）+ 语义索引（Embedding API），想用哪个用哪个
- 📊 **项目摘要注入** - AI 自动获取项目结构、技术栈、关键文件，再也不用手动介绍项目了
- 🔍 **BM25 + 符号搜索** - 结构化模式下的混合搜索，找代码又快又准
- 💾 **索引持久化** - 重启后不用重新索引，缓存都给你存好了
- 🎯 **项目类型检测** - 自动识别 Electron/React/Vue/Next.js 等框架和技术栈

### 🔧 优化
- ⚡ **索引设置 UI** - 全新的双模式切换界面，结构化模式标记为"推荐"
- 📦 **配置统一** - `indexConfig` 一个 key 管所有索引配置，不再分散
- 🔇 **Tree-sitter 警告** - 终于把那个烦人的 eval 警告干掉了
- 🎨 **摘要格式优化** - 符号带图标（📦 类、ƒ 函数），目录带文件数

### 🐛 Bug 修复
- 🔄 **Chat 模式摘要** - 之前只有 Agent 模式有项目摘要，现在 Chat 模式也有了
- 🔧 **IPC 初始化** - 修复获取状态/摘要时服务未初始化的问题
- 🛡️ **搜索错误处理** - `codebase_search` 工具不再返回神秘的 "Unknown error"

---

## [1.5.14] - 2026-01-16 🔧 终端管理优化

> "关了就是关了，别给我留尾巴" —— 强迫症患者的心声

### 🐛 Bug 修复
- 🖥️ **终端空白问题** - 关闭面板后再打开不再是空白了，会自动创建新终端
- 📦 **模块路径修复** - 打包后 `shared/constants` 找不到的问题搞定了
- ⚙️ **Git 白名单保存** - 保存设置后 Git 命令不再失效

### ✨ 新功能
- 🛡️ **命令白名单 UI** - 设置里可以编辑 Shell 和 Git 命令白名单了

### 🔧 优化
- 🚀 **启动优化** - 终端面板不再自动创建，用户打开时才创建
- 📝 **TypeScript 配置** - 整理了 tsconfig，IDE 不再报红了
- 🧹 **进程清理** - 关闭终端面板时会清理所有终端进程

---

## [1.5.13] - 2026-01-15 ☕ 泡了杯龙井，修了个终端

> "终端空白？不存在的。" —— 某位不愿透露姓名的开发者

### ✨ 新功能
- ⚙️ **MCP 自动连接开关** - 终于可以控制 MCP 服务器是否自动连接了，不想连就不连，任性！

### 🐛 Bug 修复
- 🖥️ **终端空白问题** - 切换工作区后终端不再装死，乖乖显示内容
- 🔧 **PTY 创建检查** - 修复了一个"我以为成功了但其实没有"的尴尬 bug

### 🚀 性能优化
- ⚡ **启动加速** - MCP 服务改为延迟初始化，启动快了那么一丢丢
- 🧹 **代码瘦身** - 清理了一堆"为了兼容而存在"的代码，轻装上阵

---

## [1.5.12] - 2026-01-15 🔍 搜索引擎大换血

> 告别 Serper，拥抱 Google PSE，省钱又好用

### ✨ 新功能
- 🔄 **检查点回滚增强** - 回滚时连图片和上下文都给你恢复，贴心不？
- 🔍 **网络搜索重构** - Google PSE + DuckDuckGo 双引擎，搜啥都行
- ⚙️ **搜索配置界面** - 设置里就能配 Google API，不用改代码了
- 🌐 **Jina Reader 集成** - read_url 现在能读 JS 渲染的页面了，SPA 也不怕

### 🐛 Bug 修复
- � **表格渲染f** - AI 输出的表格终于正常显示了 (感谢 @kerwin)

### 🚀 优化
- ⬆️ **Electron 39** - 升级框架，修复安全漏洞
- � *持*搜索提示优化** - 教会 AI 一次搜完，别分三次
- ⏱️ **超时调整** - read_url 默认 60 秒，慢网站也能抓

### 🔧 重构
- 🧠 **压缩管理器** - 上下文压缩逻辑整合，代码更清爽

---

## [1.5.11] - 2026-01-15 🛡️ 类型安全加固

> 把 any 赶出代码库的一天

### � Bug 修复
- 🔧 **跨平台兼容** - Performance 类型问题搞定
- � **依赖同改步** - package-lock.json 终于和 package.json 对上了

### 🔧 重构
- 🛡️ **类型安全** - 移除不安全的类型断言 (感谢 @kerwin)
- 🧪 **测试重组** - 测试结构更清晰，覆盖更全面

---

## [1.5.10] - 2026-01-14 ✨ 富文本来了

> Agent 的输出终于不只是纯文本了

### ✨ 新功能
- 🎨 **富文本支持** - Agent 工具执行结果支持多种格式

### �类 Bug 修复
- 🔇 **生产环境静音** - 控制台不再刷屏
- ⏱️ **更新检查** - 不再无限等待 (#12)

### 🔧 重构
- 🛡️ **类型改进** - 又干掉了一批 any (感谢 @kerwin)

---

## [1.5.9] - 2026-01-14 📟 终端进化

> 终端现在会告诉你它怎么了

### ✨ 新功能
- 📟 **终端事件** - PTY 退出和错误都有事件通知了

### 🐛 Bug 修复
- ⏱️ **更新检查** - 修复挂起问题
- 🔧 **路径处理** - 更健壮的验证和日志

### 🚀 优化
- 🍎 **CI 发布** - macOS arm64 文件名统一

---

## [1.5.8] - 2026-01-14 🔒 安全小补丁

### 🐛 Bug 修复
- �  **路径验证** - 更严格的文件处理

---

## [1.5.7] - 2026-01-14 🔀 Git 分支侦探

> 分支检测失败？我有 Plan B！

### � Bug 修复
- 🔀 **Git 分支检测** - 添加回退方法，再也不会显示 HEAD 了
- 🐛 **提示词预览** - MiniMax 2.1 think 标签显示正常了 (感谢 @kerwin)

### 🔧 重构
- 🏗️ **工具执行优化** - 审批流程和快照管理
- �️ A**类型安全** - 继续消灭 any (感谢 @kerwin)
- 📝 **日志统一** - console 全换成 Logger (感谢 @kerwin)

---

## [1.5.6] - 2026-01-14 🛠️ Agent 大重构

> 代码量减少了，功能却更强了

### ✨ 新功能
- 🛠️ **审批工作流** - 工具执行前可以审批了
- 🎯 **动态工具过滤** - 根据模式自动过滤可用工具
- � *复*Agent 指南** - 工具使用文档更完善

### 🔧 重构
- 🏗️ **Agent 架构** - 核心循环和上下文压缩重组
- 🧠 **压缩管理器** - 统一管理，统计更清晰
- 📋 **Prompt 系统** - 类型定义整合

### 🐛 Bug 修复
- 🐛 **提示词预览** - 显示问题修复
- � **Git  分支** - 不再显示 HEAD

---

## [1.5.5] - 2026-01-13 📖 文档日

### ✨ 新功能
- 📖 **Agent 指南** - 工具使用文档更完善

### � Bulg 修复
- 🔧 **Monaco 类型** - 配置覆盖说明 (感谢 @kerwin)

---

## [1.5.4] - 2026-01-12 🤖 AI 能力升级

> 更聪明的 Agent，更好用的工具

### ✨ 新功能
- 🤖 **文件处理增强** - Agent 更懂文件操作了
- �  **Google AI SDK** - 消息处理更强
- 🎨 **GPT Tokenizer** - 上下文管理更精准
- 📥 **API 导入向导** - 配置解析更智能
- 🎯 **ask_user 工具** - 计划模式工作流指南

### � 重构：
- 🛡️ **TypeScript 优化** - 类型守卫加持 (感谢 @kerwin)
- ⚡ **App 性能** - 组件优化 (感谢 @kerwin)

### 🐛 Bug 修复
- 🔧 **更新安装** - 日志和延迟执行优化
- 📦 **CI 发布** - 多架构元数据处理

---

## [1.5.2] - 2026-01-12 📚 社区建设

### ✨ 新功能
- � **贡献系指南** - 欢迎来贡献代码！

---

## [1.5.1] - 2026-01-10 🔧 稳定性修复

### 🐛 Bug 修复
- �  **CI 内存溢出** - 降级 electron-builder 确保稳定
- 🎨 **Regenerate 按钮** - 位置和国际化修复
- 📝 **外部修改对话框** - AI 编辑后不再误报
- 🔌 **Monaco API** - v0.55 兼容性修复

---

## [1.5.0] - 2026-01-10 🎉 自动更新上线！

> 终于不用手动下载了

### ✨ 新功能
- 🔄 **自动更新** - 安装版自动下载安装，便携版提示下载
- 🧠 **4 级压缩** - L4 自动切换新会话并携带摘要
- � **压缩可视化** `- 状态栏显示压缩级别和动画

---

## [1.4.0] - 2026-01-09 🖼️ 视觉能力解锁

> AI 终于能看图了！

### ✨ 新功能
- 🖼️ **图片输入** - LLM 支持视觉能力
- ✨ **UI 美化** - shimmer 效果、滚动阴影、毛玻璃优化

### 🔧 重构
- �️模 **Agent 架构** - 统一上下文管理，优化 Prompt 系统

---

## [1.3.8] - 2026-01-06 🛠️ LSP 修复日

### 🐛 Bug 修复
- 🛠️ **Deno LSP** - TypeScript 项目不再误触发
- � *d*生产日志** - 自动禁用控制台输出
- 🔄 **MCP 初始化** - 不再重复初始化

### 🔧 重构
- 🔧 **类型系统** - 统一 `@shared/types` 为单一来源

---

## [1.3.7] - 2026-01-05 🌳 语法解析大升级

### ✨ 新功能
- 🌳 **Tree-sitter** - 新增 20+ 语言支持
- 📁 **LSP 目录** - 支持自定义安装路径
- 🔍 **智能根目录** - 自动识别 monorepo 子项目
- 📊 **LSP 指示器** - 状态栏显示服务器状态

---

## [1.3.0] - 2026-01-02 🎯 模型选择器重构

### ✨ 新功能
- 🎯 **模型选择器** - 聊天面板新增下拉选择
- ✨ **自定义 Embedding** - 支持配置自定义 API
- 🔍 **混合搜索** - RRF 结果融合
- ⚡ **Embedding 限流** - 速率限制和重试

### 🔧 重构
- 🏗️ **Provider 架构** - 统一厂商配置存储
- 🛠️ **Result 类型** - 统一 IPC 返回类型
- 📝 **Editor 拆分** - 提取子组件

### 🚀 优化
- 🚀 **流式缓冲** - requestAnimationFrame 优化

---

## [1.2.9] - 2026-01-01 🔌 MCP 协议支持

> 新年第一天，MCP 来了！

### ✨ 新功能
- 🔌 **MCP 协议** - 集成 Model Context Protocol
- 📄 **富文本渲染** - 支持 Markdown/图片/表格
- 🎯 **UI/UX 设计系统** - 新增设计数据库

---

## [1.2.8] - 2025-12-31 🔒 安全加固

### 🔒 安全
- 🔒 **文件监听器** - 安全性优化
- 🔒 **终端命令** - 执行安全性优化

---

## [1.2.7] - 2025-12-31 🍞 Toast 重构

> 2025 年的最后一天，重构了 Toast

### 🔧 重构
- 🍞 **Toast 系统** - 全新的通知提示系统

---

> 🎊 感谢使用 Adnify！有问题欢迎提 Issue，有想法欢迎 PR！
